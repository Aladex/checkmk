Title: Agent controller: Check agent socket operability on Unix
Class: feature
Compatible: compat
Component: checks
Date: 1650637258
Edition: cre
Knowledge: undoc
Level: 1
Version: 2.2.0i1

Upon startup, the agent controller (<tt>cmk-agent-ctl</tt>) now checks if the
agent socket is operational on Unix systems. If not, only the subcommands

- <tt>delete</tt>

- <tt>delete-all</tt>

- <tt>help</tt>

- <tt>proxy-register</tt>

- <tt>status</tt>

are available, all other subcommands will abort. In particular, we refuse the
agent registration. A non-operational socket can hint at <tt>xinetd</tt> systems.
On such systems, a successful registration would mislead the user into
believing that the agent communication is now TLS encrypted, which is not the
case.

Furthermore, the operational status of the agent socket is also reported by
the <tt>status</tt> subcommand.
